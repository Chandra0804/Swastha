import java.io.BufferedReader;
import java.io.FileReader;
import java.sql.*;


public class CSV_To_Database
{

public static void main(String[] args)
{


try
{

String csvFilePath = "E:\\IIIT SRI CITY\\SEMESTER - 3\\CSV_Date_For_Project.csv";


Class.forName("com.mysql.cj.jdbc.Driver");
Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/Swastha", "root", "1234");
con.setAutoCommit(false);
String sql = "insert into Patient values (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)";


PreparedStatement statement = connection.prepareStatement(sql);
BufferedReader lineReader = new BufferedReader(new FileReader(csvFilePath));





String lineText = null;
 
int count = 0;
 
lineReader.readLine(); 

while ((lineText = lineReader.readLine()) != null) 
{
String[] data = lineText.split(",");


String ID           =  data[0];
String name         =  data[1];
String blood_group  =  data[2];
String dob          =  data[3];
String email        =  data[4];
String password     =  data[5];
String gender       =  data[6];

String address = "";
int index = 7;

while (true)
{
boolean isNumeric = data[index].chars().allMatch( Character::isDigit );
if (isNumeric)
	{ int length = address.length();
	  address = address.substring(2, length - 1);
	  break;
	}
else
	{ address = address + "," + data[index];
	  index = index + 1;
	}
}

int pincode         =  Integer.parseInt(data[index]);
int weight          =  Integer.parseInt(data[index + 1]);
double height       =  Double.parseDouble(data[index + 2]);
	
statement.setString(1, ID);
statement.setString(2, name);
statement.setString(3, blood_group);
statement.setString(4, dob);
statement.setString(5, email);
statement.setString(6, password);
statement.setString(7, gender);
statement.setString(8, address);
statement.setInt(9, pincode);
statement.setInt(10, weight);
statement.setDouble(11, height);

statement.addBatch();
 
if (count % batchSize == 0)
	statement.executeBatch();


}



 
lineReader.close();

statement.executeBatch();
connection.commit();
connection.close();



}


catch(NumberFormatException e)
{
return false;
}




catch(Exception e)
{
System.out.println("\nAn Exception has Occurred\n");
System.err.println(e);
}